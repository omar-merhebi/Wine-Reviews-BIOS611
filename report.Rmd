---
output:
  pdf_document:
    extra_dependencies: ["float"]
---
# Predicting Wine Quality and Price

## Introduction
For this project, I am attempting to see if we can use a relatively simple neural network to predict the price and quality of wine based on a text-based description by a reviewer as well as some other characteristics such as its year and country/region of origin. The quality in this dataset is determined by the number of points assigned by Wine Magazine. My hypothesis is that we will be able to create two neural nets, each with high predicitive power of price and quality using the tokenized description as well as the other variables from the dataset. 

## Preliminary Data Exploration
First, we want to take a look at overall trends and patterns in this dataset. First, I will take a look at the distribution of the target variables (price and points). First let's take a look at points:

![Histogram of wine point values.](./figures/histogram-by-points.png){width=70%}

We can see that the point values for the wines are pretty normally distributed, although they don't span the full range of point values (they go from 80 to ~95). This is likely because this dataset comes from Wine Magazine and I believe that they only include wines that they recommend in this dataset. Moving on let's take a look at the price distribution, which has a much wider range.

```{r, fig.show='hold', out.width='50%', echo=FALSE, fig.cap='Histograms of wine prices with outliers included (left) and with outliers removed (right).', fig.pos="H"}
knitr::include_graphics('./figures/histogram-by-price-full.png')
knitr::include_graphics('./figures/histogram-by-price-no-outliers.png')
```

As can be seen, the range of wine prices is much much larger, with some wines costing over $3,000 a bottle! These higher price wines though, are quite rare and won't be useful in the training set of our neural network. As such, we remove the outliers. The threshold for removing outliers is defined as the following:


$$outliers > Q_3 + 1.5 \times IQR \\$$

where

$IQR = Q_3 - Q_1$

$Q_3 = \text{third quartile}$, and

$Q_1 = \text{first quartile}$

$\text{ }$

The first and third quartile are defined as the values below which 25% and 75% of price values fall, respectively. After removing the outliers, we see the prices have a distribution that is skewed left, towards cheaper wines. 


Finally, I wanted to see if there was bias towards a specific region of thw world in this dataset, as I suspected the distributions of wine in this dataset would not be balanced. The original dataset listed the wines by country, but there are way too many to try to plot the counts of wines from each country, and I also thought that grouping the wines by continent would give a better idea as to which regions are over- and under-represented. The distribution of wines by continent is shown below.

![Barplot of wine counts by continent.](./figures/histogram-by-continent.png){width=50%}

I did expect this data to be imbalanced and show more wines from Europe and North America, as these are areas with extensive wine industries (think Napa, France, Italy, etc.) but I did not expect the imbalance to be so drastic. If this was not a project for a course and I was trying to seriously develop a neural network to make predictions on this data, this would a problem and I would have to do some over- or under-sampling of wines to balance out this data. But, we are just going to carry forward and it'll be interesting to see if this data imbalance carries over in how the model performs. 

